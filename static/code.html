<script>
async function verifyCode() {
  const code = document.getElementById("codeInput").value.trim();
  const error = document.getElementById("error");
  error.textContent = "";

  if (!code) {
    error.textContent = "개인 코드를 입력하세요.";
    return;
  }

  const res = await apiFetch("/api/verify-code", {
    method: "POST",
    body: JSON.stringify({ access_code: code })
  });

  let data;
  try {
    data = await res.json();
  } catch {
    error.textContent = "서버 오류 (500)";
    return;
  }

  if (!res.ok) {
    error.textContent = data.detail || "인증 실패";
    return;
  }

  if (data.role === "admin") {
    window.location.href = "/admin";
  } else {
    window.location.href = "/user";
  }
}
</script>

